{% extends "layout.html" %}

    {% block css %}
        <link rel="stylesheet" href="/static/css/bootstrap.css">
        <link rel="stylesheet" href="/static/css/layout.css">
        <link rel="stylesheet" href="/static/css/task.css">
    {% endblock %}

{% block table %}

        <div id="ids">

        </div>

        <div >
                <input id="cmd" type="text">
                <input type="button" value="start" onclick="start_cmd()">
        </div>

       <table class="table table-hover table-bordered" width="50px">
        <tr>


            <th>IP</th>


        </tr>

        {% for server in servers %}
        <tr onclick="append_id({{ server.id }});">

{#            <td id="id">{{ server.id }}</td>#}
            <td>{{ server.ip }}</td>


        </tr>
        {% endfor %}
    </table>
    <div id="msg"></div>


{% endblock %}

    {% block js %}
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.js"></script>
    <script>

        function start_cmd(){

            var cmd = $('#cmd').val();
            idss = JSON.stringify(ids);
            ids = [];
           $.ajax({
            url:'/task/cmd_run/',
            type:'POST',
            data:{"ids":idss,"cmd":cmd},
            dataType: "json",
            success:function(arg){
                var mag = arg.responseText;
                tem = $('#msg').html(mag);
                console.log(arg);

            },
            error:function(arg){
                $('#msg').html(arg.responseText);
                console.log(arg.responseText)

            }
        });

        }
        var ids = [];
        function append_id(id){

            ids.push(id);

        }



    </script>
    {% endblock %}
